# UTM roles and, when applicatble, their scopes.
#   This is the master data for the Role and Scopes for the
#   FIMS Authorization Server.
#   Its schema is defined as a domain in swgger spec.
#

UTM_AUTHORITY:
    description: |
      A small set of trusted users who manage identities of all core UTM
      components such as USSs.

FIMS_ADMIN:
    description: |
        (Alternative names... FIMS Elevated Privs)
        This role enables an IT admin to maintain FIMS, for example by managing
        databases and servers via command line interface (CLI).  This role
        should not, in general, allow reading FIMS business data as knowledge
        of FIMS data is usually not needed to get the job done. Multi-Factor
        Authentication (MFA) should be enforced users with this role,
        and the number of users with this role should be minimized.

FIMS_SME:
    description: |
        (Alternative name... FIMS Manager)
        A user who is a FIMS Subject Matter Expert (SME) that
        manages airspace constraints and other aeronautical data
        This user is typically a client to the FIMS Ops server.
    identity_owner: UTM_AUTHORITY
    scopes:
        - utm.nasa.gov_write.fimsadmin

FIMS_AUTHZ:
    description: This role is intrinsic to the FIMS Authorization server.
    This role cannot create, modify or delete identities, rather it
    authenticates UTM principals.
    identity_owner: UTM_AUTHORITY
    scopes:
      - utm.nasa.gov_read.fimsadmin

FIMS_OPS:
    description: This role manages the interface between the USS Network and
    the ANSP.  This role is intrinsic to the FIMS_OPS server.
    identity_owner: UTM_AUTHORITY
    scopes:
        - utm.nasa.gov_write.operation
        - utm.nasa.gov_write.message
        - utm.nasa.gov_write.constraint
        - utm.nasa.gov_read.fimsadmin

VEHICLE_AUTHORITY:
    identity_owner: TBD; May be a set of trusted commercial entities
    description: |
      This role can create, modify and delete vehicle registrations.
      Assigned to a small set of trusted entities by out-of-band processes tdb.
      Enables a users who are Vehicle Subject Matter Experts
      to manage vehicle registrations.

VEHICLE_REGISTRATION_CHECKER:
    description:
      Checks vehicle registrations using read-only access to registration data.
      This role cannot create, modify or delete vehicle registrations, and
      has access to a redacted data set.
    identity_owner: VEHICLE_AUTHORITY
    scopes:
      - utm.nasa.gov_read.uvin
      - utm.nasa.gov_read_min.uvin

USS_BASIC:
    description: A USS
    identity_owner: UTM_AUTHORITY
    scopes:
        - utm.nasa.gov_write.operation
        - utm.nasa.gov_write.message
        - utm.nasa.gov_read.contraint
        - utm.nasa.gov_read_min.uvin

USS_PUBLIC_SAFETY:
    description: |
       A USS with the capability to support public safety entities, by supporting
       queries. This role can be assigned only to a principal that has the
       USS_BASIC role. The UTM Authority assigns role after out-of-band
       vetting, which the vetting includes some testing mechanism and liability
       assumptions TBD.
    identity_owner: UTM_AUTHORITY
    scopes:
        - utm.nasa.gov_write.publicsafety
        - utm.nasa.gov_read.uvin

USS_CONSTRAINT_MANAGER:
    description: |
       A USS with the capabiity to support manage airspace constraints and
       other aeronautical data. This role can be assigned only to a principal
       that has the USS_BASIC role.
    identity_owner: UTM_AUTHORITY
    scopes:
        - utm.nasa.gov_write.constraint
